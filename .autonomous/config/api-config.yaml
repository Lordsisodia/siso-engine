# RALF API Gateway Configuration
# Part of Feature F-012 (API Gateway & External Service Integration)
#
# Configuration file for RALF API Gateway, authentication, rate limiting,
# webhook receiver, and service connectors.
#
# Copy this file to ~/.blackbox5/api-config.yaml and customize with your settings.
# NEVER commit this file to version control with real API keys or tokens!

# ==============================================================================
# API Server Configuration
# ==============================================================================

server:
  # Server binding
  host: "localhost"
  port: 5000
  debug: false

  # CORS settings
  cors_enabled: true
  cors_origins:
    - "http://localhost:3000"
    - "http://localhost:8080"
    # Add production origins:
    # - "https://dashboard.blackbox5.com"

# ==============================================================================
# Authentication Configuration
# ==============================================================================

auth:
  # API keys for authentication
  # Generate strong random keys. Example: python -c "import secrets; print(secrets.token_urlsafe(32))"
  api_keys:
    - name: "default"
      key: "CHANGE_THIS_TO_STRONG_RANDOM_KEY"
      scopes:
        - "read:tasks"
        - "write:tasks"
        - "read:metrics"
        - "read:queue"
        # "*" means all scopes (use carefully)
        # - "*"

    # Additional keys can be added:
    # - name: "read-only"
    #   key: "another-random-key-here"
    #   scopes:
    #     - "read:tasks"
    #     - "read:metrics"

  # Rate limiting
  rate_limit:
    enabled: true
    requests_per_minute: 100

# ==============================================================================
# Webhook Configuration
# ==============================================================================

webhooks:
  # Webhook secret for signature verification
  # Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
  secret: "CHANGE_THIS_TO_RANDOM_WEBHOOK_SECRET"

  # Signature algorithm (sha256 is recommended)
  signature_algorithm: "sha256"

  # Enable/disable webhook services
  services:
    slack:
      enabled: false
    jira:
      enabled: false
    trello:
      enabled: false
    github:
      enabled: false

# ==============================================================================
# Service Connectors Configuration
# ==============================================================================

connectors:
  # --------------------------------------------------------------------------
  # Slack Connector
  # --------------------------------------------------------------------------
  slack:
    enabled: false  # Set to true to enable

    # Incoming Webhook URL (simpler, recommended for notifications only)
    # Get from: https://api.slack.com/messaging/webhooks
    webhook_url: "YOUR-SLACK-WEBHOOK-URL-HERE"  # Replace with actual URL

    # Bot Token (for rich messages, file uploads, slash commands)
    # Get from: https://api.slack.com/apps
    bot_token: "xoxb-YOUR-BOT-TOKEN-HERE"  # Replace with actual token

    # Default channel for notifications
    default_channel: "#ralf-notifications"

    # Optional: Override retry settings
    # max_retries: 3
    # retry_delay: 1.0
    # timeout: 30

  # --------------------------------------------------------------------------
  # Jira Connector
  # --------------------------------------------------------------------------
  jira:
    enabled: false  # Set to true to enable

    # Jira instance URL
    base_url: "https://your-domain.atlassian.net"

    # User email for authentication
    email: "your-email@example.com"

    # API token (NOT your password)
    # Get from: https://id.atlassian.com/manage-profile/security/api-tokens
    api_token: "your-jira-api-token-here"

    # Project key for issues
    project_key: "RALF"

    # Default issue type
    default_issue_type: "Task"

    # Optional: Override retry settings
    # max_retries: 3
    # retry_delay: 1.0
    # timeout: 30

  # --------------------------------------------------------------------------
  # Trello Connector
  # --------------------------------------------------------------------------
  trello:
    enabled: false  # Set to true to enable

    # API key and secret
    # Get from: https://trello.com/app-key
    api_key: "your-trello-api-key-here"
    api_secret: "your-trello-api-secret-here"

    # OAuth token
    # Get from: https://trello.com/1/authorize?key=...&name=RALF&scope=read,write&expiration=never&response_type=token
    token: "your-trello-token-here"

    # Default board and list
    default_board: "RALF Tasks"
    default_list: "To Do"

    # Optional: Override retry settings
    # max_retries: 3
    # retry_delay: 1.0
    # timeout: 30

# ==============================================================================
# Advanced Settings
# ==============================================================================

# Logging configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  file: null  # Set to file path to enable file logging
  # file: "~/.blackbox5/logs/api-server.log"

# Performance tuning
performance:
  # Maximum request body size (MB)
  max_content_length: 16

  # Request timeout (seconds)
  request_timeout: 30

  # JSON sort keys in responses
  json_sort_keys: false

# ==============================================================================
# Notes
# ==============================================================================

# Security Best Practices:
# 1. Use strong, random API keys and secrets
# 2. Never commit this file with real credentials
# 3. Rotate API keys and secrets regularly
# 4. Use environment variables for sensitive data in production
# 5. Enable rate limiting to prevent abuse
# 6. Use HTTPS in production
# 7. Restrict CORS origins to trusted domains
# 8. Use minimal required scopes for API keys

# Connector Setup Guides:
#
# Slack:
# 1. Create Incoming Webhook: https://api.slack.com/messaging/webhooks
# 2. Or create Bot App: https://api.slack.com/apps
# 3. Copy webhook URL or bot token to config
# 4. Set enabled: true
#
# Jira:
# 1. Get API token: https://id.atlassian.com/manage-profile/security/api-tokens
# 2. Use email + API token (NOT password)
# 3. Create project in Jira
# 4. Set project_key to match
# 5. Set enabled: true
#
# Trello:
# 1. Get API key: https://trello.com/app-key
# 2. Authorize token: https://trello.com/1/authorize?key=...&name=RALF
# 3. Create board in Trello
# 4. Set default_board to match
# 5. Set enabled: true

# ==============================================================================
# End of Configuration
# ==============================================================================
