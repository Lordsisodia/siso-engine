# BMAD Workflow Schema
# Schema for workflow YAML definitions in workflows/

# Schema Version
version: "1.0.0"

# Workflow Definition Structure
workflow:
  # Required fields
  name: string              # Workflow name (e.g., "create-prd")
  command: string           # 2-letter command code (e.g., "CP")
  description: string       # One-line description

  # Skill mapping
  skill: string             # Skill file name (e.g., "bmad-pm")
  agent: string             # Agent name (e.g., "John")

  # Complexity
  complexity: string        # simple | medium | complex

  # Steps definition
  steps:
    - name: string          # Step identifier (e.g., "discovery")
      title: string         # Human-readable step title
      description: string   # What this step does
      actions: []           # List of actions in this step

  # A/P/C Menu configuration
  apc_menu:
    enabled: true           # Whether A/P/C menu is used
    options:
      advanced:
        label: "Advanced"
        description: "Full workflow with all steps"
      party:
        label: "Party"
        description: "Multi-agent collaborative mode"
      continue:
        label: "Continue"
        description: "Resume from last checkpoint"

  # WIP tracking
  wip_tracking:
    enabled: true           # Whether WIP tracking is used
    directory: "./wip"
    filename_pattern: "{command}-{short-description}-{timestamp}.md"

  # Output artifacts
  outputs:
    - type: string          # Artifact type (prd, code, test, etc.)
      location: string      # Where artifact is created
      format: string        # File format

  # Verification
  verification:
    - string                # Checklist items for verification

# Example Workflow Definition
example:
  name: "create-prd"
  command: "CP"
  description: "Create Product Requirements Document"
  skill: "bmad-pm"
  agent: "John"
  complexity: "complex"

  steps:
    - name: "discovery"
      title: "Discovery"
      description: "Understand product idea, users, market"
      actions:
        - "Interview user about problem"
        - "Define target users"
        - "Identify constraints"
        - "Document assumptions"

    - name: "success-criteria"
      title: "Success Criteria"
      description: "Define user/business/technical success"
      actions:
        - "Define user success metrics"
        - "Define business success metrics"
        - "Define technical success metrics"

    - name: "user-journeys"
      title: "User Journeys"
      description: "Map narrative journeys for all user types"
      actions:
        - "Map user personas"
        - "Define user flows"
        - "Document edge cases"

    - name: "domain-requirements"
      title: "Domain Requirements"
      description: "Domain-specific needs"
      actions:
        - "Identify domain constraints"
        - "Document regulatory requirements"
        - "Define domain terminology"

    - name: "functional-requirements"
      title: "Functional Requirements"
      description: "THE CAPABILITY CONTRACT (20-50 FRs)"
      actions:
        - "List all functional capabilities"
        - "Group into feature areas"
        - "Prioritize by value"

    - name: "non-functional-requirements"
      title: "Non-Functional Requirements"
      description: "Performance, security, reliability"
      actions:
        - "Define performance requirements"
        - "Define security requirements"
        - "Define reliability requirements"

    - name: "polish"
      title: "Polish"
      description: "Optimize for flow and readability"
      actions:
        - "Review for clarity"
        - "Check for redundancy"
        - "Improve formatting"

    - name: "complete"
      title: "Complete"
      description: "Finalize and suggest next steps"
      actions:
        - "Final review of PRD"
        - "Update WIP status to completed"
        - "Archive WIP file"
        - "Output final PRD"
        - "Suggest next steps (UX, Architecture)"

  apc_menu:
    enabled: true
    options:
      advanced:
        label: "Advanced"
        description: "Full workflow with all steps"
      party:
        label: "Party"
        description: "Multi-agent collaborative mode"
      continue:
        label: "Continue"
        description: "Resume from last checkpoint"

  wip_tracking:
    enabled: true
    directory: "./wip"
    filename_pattern: "cp-{name}-{timestamp}.md"

  outputs:
    - type: "prd"
      location: "./planning/prd-{name}.md"
      format: "markdown"

  verification:
    - "PRD has clear problem statement"
    - "User journeys are complete"
    - "20-50 functional requirements defined"
    - "NFRs cover performance, security, reliability"
    - "Document is polished and readable"
